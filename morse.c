#include <string.h>

#include "morse.h"

static struct morse_map map[63] = {
    { 'E', ".",     1, 0 },
    { 'T', "-",     1, 0 },
    { 'I', "..",    2, 0 },
    { 'A', ".-",    2, 0 },
    { 'N', "-.",    2, 0 },
    { 'M', "--",    2, 0 },
    { 'S', "...",   3, 0 },
    { 'U', "..-",   3, 0 },
    { 'R', ".-.",   3, 0 },
    { 'W', ".--",   3, 0 },
    { 'D', "-..",   3, 0 },
    { 'K', "-.-",   3, 0 },
    { 'G', "--.",   3, 0 },
    { 'O', "---",   3, 0 },
    { 'H', "....",  4, 0 },
    { 'V', "...-",  4, 0 },
    { 'F', "..-.",  4, 0 },
    {  0 , "..--",  4, 0 },
    { 'L', ".-..",  4, 0 },
    {  0 , ".-.-",  4, 0 },
    { 'P', ".--.",  4, 0 },
    { 'J', ".---",  4, 0 },
    { 'B', "-...",  4, 0 },
    { 'X', "-..-",  4, 0 },
    { 'C', "-.-.",  4, 0 },
    { 'Y', "-.--",  4, 0 },
    { 'Z', "--..",  4, 0 },
    { 'Q', "--.-",  4, 0 },
    {  0 , "---.",  4, 0 },
    {  0 , "----",  4, 0 },
    { '5', ".....", 5, 0 },
    { '4', "....-", 5, 0 },
    {  0 , "...-.", 5, 0 },
    { '3', "...--", 5, 0 },
    {  0 , "..-..", 5, 0 },
    {  0 , "..-.-", 5, 0 },
    {  0 , "..--.", 5, 0 },
    { '2', "..---", 5, 0 },
    {  0 , ".-...", 5, 0 },
    {  0 , ".-..-", 5, 0 },
    { '+', ".-.-.", 5, 0 },
    {  0 , ".-.--", 5, 0 },
    {  0 , ".--..", 5, 0 },
    {  0 , ".--.-", 5, 0 },
    {  0 , ".---.", 5, 0 },
    { '1', ".----", 5, 0 },
    { '6', "-....", 5, 0 },
    { '=', "-...-", 5, 0 },
    { '/', "-..-.", 5, 0 },
    {  0 , "-..--", 5, 0 },
    {  0 , "-.-..", 5, 0 },
    {  0 , "-.-.-", 5, 0 },
    {  0 , "-.--.", 5, 0 },
    {  0 , "-.---", 5, 0 },
    { '7', "--...", 5, 0 },
    {  0 , "--..-", 5, 0 },
    {  0 , "--.-.", 5, 0 },
    {  0 , "--.--", 5, 0 },
    { '8', "---..", 5, 0 },
    {  0 , "---.-", 5, 0 },
    { '9', "----.", 5, 0 },
    { '0', "-----", 5, 0 },

    { .end = 1 }
};

static int morse_streq(struct morse_map *, char *);

static int
morse_streq(struct morse_map *m, char *str)
{
    if(m->len != strlen(str))
        return 0;

    return strcmp(str, m->morse) == 0;
}

char
morse_lookup_by_morse(char *morse)
{
    for(struct morse_map *selm = map; !selm->end; ++selm)
        if(morse_streq(selm, morse))
            return selm->ch;

    return 0;
}

char *
morse_lookup_by_char(char ch)
{
    for(struct morse_map *selm = map; !selm->end; ++selm)
        if(selm->ch == ch)
            return selm->morse;

    return "";
}
